<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Slay-0.1 AI</title>

<style>
    body {
        margin: 0;
        padding: 0;
        background: #0d0d0d;
        font-family: 'Poppins', sans-serif;
        color: #fff;
        display: flex;
        flex-direction: column;
        height: 100vh;
        overflow: auto;
    }

    /* Header */
    .header {
        width: 100%;
        padding: 18px 0;
        text-align: center;
        font-size: 26px;
        font-weight: 700;
        background: linear-gradient(90deg, #7f00ff, #e100ff);
        box-shadow: 0 0 15px #9b00ff;
    }

    /* Chat box */
    #chat-box {
        flex: 1;
        overflow-y: auto;
        padding: 16px;
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    /* Chat bubbles */
    .bubble {
        max-width: 80%;
        padding: 12px 16px;
        border-radius: 16px;
        line-height: 1.4;
        animation: fadeIn 0.3s ease;
    }

    .user {
        background: #7f00ff;
        align-self: flex-end;
        box-shadow: 0 0 8px #7f00ff;
    }

    .slay {
        background: #1a1a1a;
        border: 1px solid #7f00ff;
        box-shadow: 0 0 10px #7f00ff66;
        align-self: flex-start;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(5px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* Input area */
    .input-area {
        display: flex;
        padding: 10px;
        background: #111;
        gap: 10px;
    }

    input {
        flex: 1;
        padding: 14px;
        border-radius: 12px;
        border: none;
        outline: none;
        font-size: 16px;
        background: #222;
        color: white;
        box-shadow: inset 0 0 8px #7f00ff44;
    }

    button {
        padding: 14px 22px;
        font-size: 16px;
        font-weight: bold;
        border: none;
        border-radius: 12px;
        background: #7f00ff;
        color: #fff;
        box-shadow: 0 0 10px #7f00ff;
        cursor: pointer;
    }

    button:active {
        transform: scale(0.96);
    }

    /* Popup Modal */
    .popup-background {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.7);
        backdrop-filter: blur(4px);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 999;
    }

    .popup-box {
        background: #111;
        padding: 24px;
        width: 80%;
        max-width: 350px;
        border-radius: 12px;
        box-shadow: 0 0 12px #a200ff;
        text-align: center;
        border: 1px solid #7f00ff;
    }

    .popup-title {
        font-size: 22px;
        font-weight: 700;
        margin-bottom: 12px;
        color: #e100ff;
    }

    .popup-text {
        font-size: 15px;
        line-height: 1.4;
        margin-bottom: 20px;
    }

    .popup-btn {
        padding: 10px 18px;
        background: #7f00ff;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 15px;
        cursor: pointer;
        box-shadow: 0 0 10px #7f00ff;
    }
    /* Version Indicator */
    .version-indicator {
    width: 100%;
    text-align: center;
    font-size: 14px;
    padding: 6px 0;
    color: #cfcfcf;
    background: #101010;
    border-top: 1px solid #7f00ff44;
    box-shadow: 0 -2px 8px #7f00ff33;
    position: relative;
    }

    .version-indicator .upgrade {
    color: #e100ff;
    font-weight: 600;
    text-shadow: 0 0 6px #e100ff;
    }
</style>
</head>

<body>

<!-- POPUP -->
<div class="popup-background" id="popup">
    <div class="popup-box">
        <div class="popup-title">Developer's Note</div>

        <div class="popup-text" id="popupMessage">
            This is Slay-0.1 AI (Prototype 0.1).  
            Backend is online.
            You are ordered to not send any messages like 'Backend Error' 
            or any message like that, as it can crash the backend,
            and repairing that takes time.
        </div>

        <!-- Continue button (operable) -->
        <button class="popup-btn" id="continueBtn" onclick="closePopup()">
            Continue
        </button>

        <!-- If you want this button disabled, add: disabled -->
        <!-- <button class="popup-btn" id="continueBtn" disabled>Continue</button> -->
    </div>
</div>

<div class="header">Slay-0.1 AI</div>

<div id="chat-box"></div>

<div class="input-area">
    <input type="text" id="userInput" placeholder="Ask Slay-0.1 something...">
    <button onclick="sendMessage()">Send</button>
</div>

<div class="version-indicator">
    Slay 0.1 â†’ <span class="upgrade">0.2 coming soon</span>
</div>

<script>
function closePopup() {
    document.getElementById("popup").style.display = "none";
}

function sendMessage() {
    const input = document.getElementById("userInput");
    const chat = document.getElementById("chat-box");
    const message = input.value.trim();

    if (message === "") return;

    // user bubble
    let userBubble = document.createElement("div");
    userBubble.className = "bubble user";
    userBubble.textContent = message;
    chat.appendChild(userBubble);
    chat.scrollTop = chat.scrollHeight;

    input.value = "";

    const sendRequest = (attempt = 1) => {
        fetch("https://slay-backend-3.onrender.com/chat", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({ message })
        })
        .then(res => res.json())
        .then(data => {
            let ai = document.createElement("div");
            ai.className = "bubble slay";
            ai.textContent = data.reply;
            chat.appendChild(ai);
            chat.scrollTop = chat.scrollHeight;
        })
       .catch(err => {
    console.log("Real network error:", err);

    if (messageToSend.toLowerCase().includes("backend error")) {
        // treat as normal message, not real error
        let ai = document.createElement("div");
        ai.className = "bubble slay";
        ai.textContent = "Bro relax ðŸ’€ that's not a real error, the backend is fine.";
        chat.appendChild(ai);
        return;
    }

    let ai = document.createElement("div");
    ai.className = "bubble slay";
    ai.textContent = "Backend error ðŸ˜­ (Render free tier sleeping)";
    chat.appendChild(ai);
}); 

    sendRequest();
}
</script>

</body>
</html>
